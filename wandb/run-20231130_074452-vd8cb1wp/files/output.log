Epoch 1/200

273/273 [==============================] - 5s 13ms/step - loss: 23.7905 - recon_loss: 23.7905 - kl_loss: 3.1144 - val_loss: 14.7612 - val_recon_loss: 14.7612 - val_kl_loss: 1.6299
Epoch 2/200

273/273 [==============================] - 3s 10ms/step - loss: 13.9323 - recon_loss: 13.9323 - kl_loss: 9.2697 - val_loss: 12.7949 - val_recon_loss: 12.7949 - val_kl_loss: 18.2636
Epoch 3/200
273/273 [==============================] - 3s 10ms/step - loss: 12.1145 - recon_loss: 12.1145 - kl_loss: 39.7502 - val_loss: 10.9540 - val_recon_loss: 10.9540 - val_kl_loss: 58.0961
Epoch 4/200
273/273 [==============================] - 3s 9ms/step - loss: 10.5032 - recon_loss: 10.5032 - kl_loss: 77.6091 - val_loss: 9.6016 - val_recon_loss: 9.6016 - val_kl_loss: 89.1864
Epoch 5/200

273/273 [==============================] - 3s 10ms/step - loss: 9.3676 - recon_loss: 9.3676 - kl_loss: 107.8069 - val_loss: 8.6273 - val_recon_loss: 8.6273 - val_kl_loss: 115.4601
Epoch 6/200
273/273 [==============================] - 3s 12ms/step - loss: 8.5852 - recon_loss: 8.5852 - kl_loss: 130.2898 - val_loss: 8.1631 - val_recon_loss: 8.1631 - val_kl_loss: 141.8230
Epoch 7/200

273/273 [==============================] - 3s 10ms/step - loss: 8.0727 - recon_loss: 8.0727 - kl_loss: 161.1876 - val_loss: 7.6959 - val_recon_loss: 7.6959 - val_kl_loss: 167.8528
Epoch 8/200
273/273 [==============================] - 3s 10ms/step - loss: 7.6993 - recon_loss: 7.6993 - kl_loss: 188.0139 - val_loss: 7.3968 - val_recon_loss: 7.3968 - val_kl_loss: 199.1752
Epoch 9/200
273/273 [==============================] - 3s 10ms/step - loss: 7.3143 - recon_loss: 7.3143 - kl_loss: 212.4510 - val_loss: 7.1177 - val_recon_loss: 7.1177 - val_kl_loss: 213.8855
Epoch 10/200

273/273 [==============================] - 3s 11ms/step - loss: 6.9582 - recon_loss: 6.9582 - kl_loss: 240.0551 - val_loss: 6.8435 - val_recon_loss: 6.8435 - val_kl_loss: 245.3453
Epoch 11/200
273/273 [==============================] - 3s 13ms/step - loss: 6.6875 - recon_loss: 6.6875 - kl_loss: 272.2391 - val_loss: 6.6555 - val_recon_loss: 6.6555 - val_kl_loss: 259.5380
Epoch 12/200

273/273 [==============================] - 3s 12ms/step - loss: 6.4956 - recon_loss: 6.4956 - kl_loss: 292.0189 - val_loss: 6.5596 - val_recon_loss: 6.5596 - val_kl_loss: 282.3986
Epoch 13/200

273/273 [==============================] - 3s 11ms/step - loss: 6.2935 - recon_loss: 6.2935 - kl_loss: 322.1600 - val_loss: 6.4480 - val_recon_loss: 6.4480 - val_kl_loss: 322.6885
Epoch 14/200
273/273 [==============================] - 2s 9ms/step - loss: 6.1239 - recon_loss: 6.1239 - kl_loss: 351.3071 - val_loss: 6.3703 - val_recon_loss: 6.3703 - val_kl_loss: 349.8146
Epoch 15/200
273/273 [==============================] - 3s 9ms/step - loss: 5.9813 - recon_loss: 5.9813 - kl_loss: 376.8596 - val_loss: 6.2686 - val_recon_loss: 6.2686 - val_kl_loss: 349.0602
Epoch 16/200
273/273 [==============================] - 3s 10ms/step - loss: 5.8499 - recon_loss: 5.8499 - kl_loss: 390.8201 - val_loss: 6.2607 - val_recon_loss: 6.2607 - val_kl_loss: 381.0433
Epoch 17/200

273/273 [==============================] - 3s 10ms/step - loss: 6.7255 - recon_loss: 6.0892 - kl_loss: 63.6360 - val_loss: 6.7916 - val_recon_loss: 6.3550 - val_kl_loss: 43.6586
Epoch 18/200
273/273 [==============================] - 3s 9ms/step - loss: 6.7473 - recon_loss: 6.0880 - kl_loss: 32.9656 - val_loss: 6.9651 - val_recon_loss: 6.3996 - val_kl_loss: 28.2770
Epoch 19/200
273/273 [==============================] - 3s 10ms/step - loss: 6.8435 - recon_loss: 6.0967 - kl_loss: 24.8942 - val_loss: 7.1275 - val_recon_loss: 6.4665 - val_kl_loss: 22.0322
Epoch 20/200

273/273 [==============================] - 3s 12ms/step - loss: 6.9306 - recon_loss: 6.0841 - kl_loss: 21.1633 - val_loss: 7.2188 - val_recon_loss: 6.4659 - val_kl_loss: 18.8215
Epoch 21/200
273/273 [==============================] - 3s 10ms/step - loss: 6.9761 - recon_loss: 6.0394 - kl_loss: 18.7342 - val_loss: 7.3128 - val_recon_loss: 6.4907 - val_kl_loss: 16.4415
Epoch 22/200

273/273 [==============================] - 3s 10ms/step - loss: 7.0215 - recon_loss: 6.0182 - kl_loss: 16.7217 - val_loss: 7.3970 - val_recon_loss: 6.4941 - val_kl_loss: 15.0489
Epoch 23/200
273/273 [==============================] - 3s 11ms/step - loss: 7.1105 - recon_loss: 6.0271 - kl_loss: 15.4774 - val_loss: 7.4850 - val_recon_loss: 6.4633 - val_kl_loss: 14.5957
Epoch 24/200
273/273 [==============================] - 3s 10ms/step - loss: 7.1601 - recon_loss: 6.0075 - kl_loss: 14.4083 - val_loss: 7.6065 - val_recon_loss: 6.5361 - val_kl_loss: 13.3804
Epoch 25/200
273/273 [==============================] - 3s 10ms/step - loss: 7.1713 - recon_loss: 5.9732 - kl_loss: 13.3121 - val_loss: 7.7344 - val_recon_loss: 6.6431 - val_kl_loss: 12.1259
Epoch 26/200
273/273 [==============================] - 3s 10ms/step - loss: 7.1841 - recon_loss: 5.9354 - kl_loss: 12.4871 - val_loss: 7.7754 - val_recon_loss: 6.6409 - val_kl_loss: 11.3447
Epoch 27/200
273/273 [==============================] - 2s 9ms/step - loss: 7.2377 - recon_loss: 5.9407 - kl_loss: 11.7909 - val_loss: 7.8086 - val_recon_loss: 6.5925 - val_kl_loss: 11.0561
Epoch 28/200

273/273 [==============================] - 3s 10ms/step - loss: 7.2186 - recon_loss: 5.8721 - kl_loss: 11.2214 - val_loss: 7.7973 - val_recon_loss: 6.5664 - val_kl_loss: 10.2578
Epoch 29/200
273/273 [==============================] - 2s 9ms/step - loss: 7.2422 - recon_loss: 5.8524 - kl_loss: 10.6906 - val_loss: 7.8944 - val_recon_loss: 6.6265 - val_kl_loss: 9.7531
Epoch 30/200
273/273 [==============================] - 3s 9ms/step - loss: 7.2945 - recon_loss: 5.8467 - kl_loss: 10.3411 - val_loss: 7.9747 - val_recon_loss: 6.6173 - val_kl_loss: 9.6956
Epoch 31/200
273/273 [==============================] - 2s 9ms/step - loss: 7.2983 - recon_loss: 5.7911 - kl_loss: 10.0478 - val_loss: 7.9928 - val_recon_loss: 6.6458 - val_kl_loss: 8.9798
Epoch 32/200

273/273 [==============================] - 3s 10ms/step - loss: 7.3242 - recon_loss: 5.7809 - kl_loss: 9.6456 - val_loss: 8.1140 - val_recon_loss: 6.7169 - val_kl_loss: 8.7317
Epoch 33/200
273/273 [==============================] - 2s 9ms/step - loss: 7.3281 - recon_loss: 5.7416 - kl_loss: 9.3322 - val_loss: 8.1894 - val_recon_loss: 6.6820 - val_kl_loss: 8.8668
Epoch 34/200
273/273 [==============================] - 3s 10ms/step - loss: 7.3829 - recon_loss: 5.7432 - kl_loss: 9.1092 - val_loss: 8.1695 - val_recon_loss: 6.6168 - val_kl_loss: 8.6265
Epoch 35/200

273/273 [==============================] - 3s 10ms/step - loss: 7.4199 - recon_loss: 5.7183 - kl_loss: 8.9559 - val_loss: 8.2862 - val_recon_loss: 6.6825 - val_kl_loss: 8.4406
Epoch 36/200
273/273 [==============================] - 3s 10ms/step - loss: 7.4466 - recon_loss: 5.6997 - kl_loss: 8.7347 - val_loss: 8.3322 - val_recon_loss: 6.6799 - val_kl_loss: 8.2611
Epoch 37/200
273/273 [==============================] - 3s 9ms/step - loss: 7.4653 - recon_loss: 5.6650 - kl_loss: 8.5732 - val_loss: 8.3706 - val_recon_loss: 6.7068 - val_kl_loss: 7.9228
Epoch 38/200
273/273 [==============================] - 3s 9ms/step - loss: 7.5124 - recon_loss: 5.6640 - kl_loss: 8.4019 - val_loss: 8.5270 - val_recon_loss: 6.7766 - val_kl_loss: 7.9565
Epoch 39/200

273/273 [==============================] - 3s 11ms/step - loss: 7.5858 - recon_loss: 5.6737 - kl_loss: 8.3133 - val_loss: 8.5587 - val_recon_loss: 6.7576 - val_kl_loss: 7.8310
Epoch 40/200
273/273 [==============================] - 3s 10ms/step - loss: 7.5897 - recon_loss: 5.6369 - kl_loss: 8.1364 - val_loss: 8.6008 - val_recon_loss: 6.7719 - val_kl_loss: 7.6201
Epoch 41/200

273/273 [==============================] - 3s 10ms/step - loss: 7.6617 - recon_loss: 5.6578 - kl_loss: 8.0153 - val_loss: 8.6978 - val_recon_loss: 6.8440 - val_kl_loss: 7.4151
Epoch 42/200
273/273 [==============================] - 3s 10ms/step - loss: 7.6660 - recon_loss: 5.6405 - kl_loss: 7.7905 - val_loss: 8.7544 - val_recon_loss: 6.8564 - val_kl_loss: 7.3002
Epoch 43/200

273/273 [==============================] - 3s 12ms/step - loss: 7.7244 - recon_loss: 5.6398 - kl_loss: 7.7207 - val_loss: 8.8071 - val_recon_loss: 6.8310 - val_kl_loss: 7.3189
Epoch 44/200
273/273 [==============================] - 2s 9ms/step - loss: 7.7637 - recon_loss: 5.6362 - kl_loss: 7.5982 - val_loss: 8.8569 - val_recon_loss: 6.8908 - val_kl_loss: 7.0219
Epoch 45/200
273/273 [==============================] - 2s 9ms/step - loss: 7.7901 - recon_loss: 5.6266 - kl_loss: 7.4603 - val_loss: 8.9876 - val_recon_loss: 6.9322 - val_kl_loss: 7.0874
Epoch 46/200
273/273 [==============================] - 3s 10ms/step - loss: 7.8627 - recon_loss: 5.6324 - kl_loss: 7.4344 - val_loss: 9.0315 - val_recon_loss: 6.9814 - val_kl_loss: 6.8337
Epoch 47/200

273/273 [==============================] - 3s 10ms/step - loss: 7.9070 - recon_loss: 5.6582 - kl_loss: 7.2544 - val_loss: 9.0309 - val_recon_loss: 6.9411 - val_kl_loss: 6.7411
Epoch 48/200
273/273 [==============================] - 3s 10ms/step - loss: 7.9255 - recon_loss: 5.6400 - kl_loss: 7.1420 - val_loss: 9.1377 - val_recon_loss: 6.9595 - val_kl_loss: 6.8067
Epoch 49/200

273/273 [==============================] - 3s 10ms/step - loss: 7.9621 - recon_loss: 5.6304 - kl_loss: 7.0658 - val_loss: 9.2635 - val_recon_loss: 7.0544 - val_kl_loss: 6.6942
Epoch 50/200
273/273 [==============================] - 3s 10ms/step - loss: 8.0014 - recon_loss: 5.6178 - kl_loss: 7.0107 - val_loss: 9.2700 - val_recon_loss: 7.0438 - val_kl_loss: 6.5478
Epoch 51/200
 75/273 [=======>......................] - ETA: 1s - loss: 8.0285 - recon_loss: 5.5772 - kl_loss: 6.8090.8885 - val_loss: 9.3577 - val_recon_loss: 7.1008 - val_kl_loss: 6.4481
Epoch 52/200
  1/273 [..............................] - ETA: 5s - loss: 8.5417 - recon_loss: 5.9197 - kl_loss: 7.0864.8269 - val_loss: 9.4455 - val_recon_loss: 7.1372 - val_kl_loss: 6.4121
Epoch 53/200
211/273 [======================>.......] - ETA: 0s - loss: 8.1452 - recon_loss: 5.6547 - kl_loss: 6.7313.8269 - val_loss: 9.4455 - val_recon_loss: 7.1372 - val_kl_loss: 6.4121
106/273 [==========>...................] - ETA: 1s - loss: 8.1253 - recon_loss: 5.6056 - kl_loss: 6.6308.7325 - val_loss: 9.5187 - val_recon_loss: 7.2034 - val_kl_loss: 6.2574
 23/273 [=>............................] - ETA: 2s - loss: 8.2777 - recon_loss: 5.7014 - kl_loss: 6.6057.6523 - val_loss: 9.5748 - val_recon_loss: 7.1544 - val_kl_loss: 6.3694
238/273 [=========================>....] - ETA: 0s - loss: 8.2348 - recon_loss: 5.6594 - kl_loss: 6.6036.6523 - val_loss: 9.5748 - val_recon_loss: 7.1544 - val_kl_loss: 6.3694
168/273 [=================>............] - ETA: 0s - loss: 8.2511 - recon_loss: 5.6449 - kl_loss: 6.5154.5898 - val_loss: 9.6054 - val_recon_loss: 7.2183 - val_kl_loss: 6.1206
 72/273 [======>.......................] - ETA: 2s - loss: 8.2195 - recon_loss: 5.5444 - kl_loss: 6.5247.5244 - val_loss: 9.7594 - val_recon_loss: 7.2556 - val_kl_loss: 6.2594
268/273 [============================>.] - ETA: 0s - loss: 8.3199 - recon_loss: 5.6913 - kl_loss: 6.4113.5244 - val_loss: 9.7594 - val_recon_loss: 7.2556 - val_kl_loss: 6.2594
194/273 [====================>.........] - ETA: 0s - loss: 8.3741 - recon_loss: 5.6991 - kl_loss: 6.3692.4105 - val_loss: 9.7677 - val_recon_loss: 7.3308 - val_kl_loss: 5.9437
 68/273 [======>.......................] - ETA: 2s - loss: 8.5876 - recon_loss: 5.8514 - kl_loss: 6.3632.3573 - val_loss: 9.7869 - val_recon_loss: 7.2763 - val_kl_loss: 5.9775
270/273 [============================>.] - ETA: 0s - loss: 8.4468 - recon_loss: 5.7433 - kl_loss: 6.2870.3573 - val_loss: 9.7869 - val_recon_loss: 7.2763 - val_kl_loss: 5.9775
232/273 [========================>.....] - ETA: 0s - loss: 8.4411 - recon_loss: 5.7124 - kl_loss: 6.2016.2863 - val_loss: 9.8977 - val_recon_loss: 7.3901 - val_kl_loss: 5.8318
106/273 [==========>...................] - ETA: 1s - loss: 8.3501 - recon_loss: 5.5848 - kl_loss: 6.14501972 - val_loss: 9.8616 - val_recon_loss: 7.2924 - val_kl_loss: 5.83918
  1/273 [..............................] - ETA: 2s - loss: 8.3343 - recon_loss: 5.5665 - kl_loss: 6.0170.1449 - val_loss: 9.9955 - val_recon_loss: 7.4216 - val_kl_loss: 5.7198
160/273 [================>.............] - ETA: 1s - loss: 8.5718 - recon_loss: 5.7370 - kl_loss: 6.1626.1449 - val_loss: 9.9955 - val_recon_loss: 7.4216 - val_kl_loss: 5.7198
 45/273 [===>..........................] - ETA: 1s - loss: 8.5740 - recon_loss: 5.6776 - kl_loss: 6.1626.1341 - val_loss: 9.9484 - val_recon_loss: 7.2766 - val_kl_loss: 5.8083
270/273 [============================>.] - ETA: 0s - loss: 8.6076 - recon_loss: 5.7658 - kl_loss: 6.0466.1341 - val_loss: 9.9484 - val_recon_loss: 7.2766 - val_kl_loss: 5.8083
226/273 [=======================>......] - ETA: 0s - loss: 8.6346 - recon_loss: 5.7791 - kl_loss: 5.94890456 - val_loss: 10.1064 - val_recon_loss: 7.4784 - val_kl_loss: 5.5915
162/273 [================>.............] - ETA: 0s - loss: 8.6659 - recon_loss: 5.7689 - kl_loss: 5.91239528 - val_loss: 10.0847 - val_recon_loss: 7.3989 - val_kl_loss: 5.5956
 98/273 [=========>....................] - ETA: 1s - loss: 8.6588 - recon_loss: 5.7093 - kl_loss: 5.89918955 - val_loss: 10.2151 - val_recon_loss: 7.4913 - val_kl_loss: 5.5587
273/273 [==============================] - 3s 9ms/step - loss: 8.7215 - recon_loss: 5.8009 - kl_loss: 5.8412 - val_loss: 10.2747 - val_recon_loss: 7.5496 - val_kl_loss: 5.4502
273/273 [==============================] - 3s 9ms/step - loss: 8.7215 - recon_loss: 5.8009 - kl_loss: 5.8412 - val_loss: 10.2747 - val_recon_loss: 7.5496 - val_kl_loss: 5.4502
273/273 [==============================] - 3s 9ms/step - loss: 8.7215 - recon_loss: 5.8009 - kl_loss: 5.8412 - val_loss: 10.2747 - val_recon_loss: 7.5496 - val_kl_loss: 5.4502
/home/unixftwx/anaconda3/envs/drp/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/unixftwx/anaconda3/envs/drp/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/unixftwx/anaconda3/envs/drp/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1760: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
{'precision': 0.8573833573833574, 'recall': 0.5117714613838645, 'f1': 0.6409564904710535, 'roc_auc': 0.9719232947200481, 'auprc': 0.6771120381863228}5496 - val_kl_loss: 5.4502
{'precision': 0.8573833573833574, 'recall': 0.5117714613838645, 'f1': 0.6409564904710535, 'roc_auc': 0.9719232947200481, 'auprc': 0.6771120381863228}5496 - val_kl_loss: 5.4502
Traceback (most recent call last):
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/training/train_presence_model.py", line 45, in <module>
    main()
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/training/train_presence_model.py", line 42, in main
    train_presence_model(data, meal_type, wb_group_name)
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/training/train_presence_model.py", line 18, in train_presence_model
    fold_macro_metrics, fold_micro_metrics, best_model = cross_validation(
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/utils/model_utils.py", line 102, in cross_validation
    wandb_log_metrics(micro_results, macro_results, wb_group_name, fold)
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/utils/model_utils.py", line 25, in wandb_log_metrics
    wandb.log({"sparsity_level": int(wb_group_name.split('_')[1]), "fold": fold, **micro_results})
ValueError: invalid literal for int() with base 10: 'attempt'