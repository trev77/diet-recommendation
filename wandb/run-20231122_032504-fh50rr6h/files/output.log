Epoch 1/500
193/193 [==============================] - 2s 10ms/step - loss: 29.3105 - r_squared: 0.0747 - val_loss: 29.7190 - val_r_squared: 0.0937
Epoch 2/500
193/193 [==============================] - 1s 6ms/step - loss: 28.9453 - r_squared: 0.0978 - val_loss: 29.3016 - val_r_squared: 0.1199
Epoch 3/500
193/193 [==============================] - 1s 7ms/step - loss: 27.5785 - r_squared: 0.1850 - val_loss: 26.4546 - val_r_squared: 0.2860
Epoch 4/500
193/193 [==============================] - 1s 7ms/step - loss: 24.5071 - r_squared: 0.3570 - val_loss: 23.8343 - val_r_squared: 0.4236
Epoch 5/500
193/193 [==============================] - 1s 8ms/step - loss: 23.0631 - r_squared: 0.4344 - val_loss: 23.0715 - val_r_squared: 0.4599
Epoch 6/500
193/193 [==============================] - 1s 7ms/step - loss: 22.4902 - r_squared: 0.4575 - val_loss: 22.8251 - val_r_squared: 0.4715
Epoch 7/500
193/193 [==============================] - 1s 6ms/step - loss: 22.4127 - r_squared: 0.4632 - val_loss: 22.7250 - val_r_squared: 0.4767
Epoch 8/500
193/193 [==============================] - 1s 6ms/step - loss: 22.2529 - r_squared: 0.4716 - val_loss: 22.5531 - val_r_squared: 0.4840
Epoch 9/500
193/193 [==============================] - 1s 7ms/step - loss: 22.1005 - r_squared: 0.4783 - val_loss: 22.4198 - val_r_squared: 0.4898
Epoch 10/500
193/193 [==============================] - 1s 7ms/step - loss: 21.9626 - r_squared: 0.4874 - val_loss: 22.3267 - val_r_squared: 0.4949
Epoch 11/500
193/193 [==============================] - 1s 6ms/step - loss: 21.8471 - r_squared: 0.4915 - val_loss: 22.1968 - val_r_squared: 0.5010
Epoch 12/500
193/193 [==============================] - 1s 7ms/step - loss: 21.7352 - r_squared: 0.4966 - val_loss: 22.0359 - val_r_squared: 0.5081
Epoch 13/500
193/193 [==============================] - 2s 8ms/step - loss: 21.5578 - r_squared: 0.5052 - val_loss: 21.8580 - val_r_squared: 0.5167
Epoch 14/500
193/193 [==============================] - 1s 7ms/step - loss: 21.3284 - r_squared: 0.5156 - val_loss: 21.7220 - val_r_squared: 0.5228
Epoch 15/500
193/193 [==============================] - 1s 6ms/step - loss: 21.1937 - r_squared: 0.5229 - val_loss: 21.6186 - val_r_squared: 0.5279
Epoch 16/500
193/193 [==============================] - 1s 6ms/step - loss: 21.0939 - r_squared: 0.5265 - val_loss: 21.5689 - val_r_squared: 0.5302
Epoch 17/500
193/193 [==============================] - 1s 8ms/step - loss: 21.0460 - r_squared: 0.5302 - val_loss: 21.4713 - val_r_squared: 0.5337
Epoch 18/500
193/193 [==============================] - 1s 7ms/step - loss: 20.8407 - r_squared: 0.5381 - val_loss: 21.4080 - val_r_squared: 0.5364
Epoch 19/500
193/193 [==============================] - 1s 7ms/step - loss: 20.8352 - r_squared: 0.5369 - val_loss: 21.3841 - val_r_squared: 0.5387
Epoch 20/500
193/193 [==============================] - 2s 8ms/step - loss: 20.8174 - r_squared: 0.5399 - val_loss: 21.3120 - val_r_squared: 0.5415
Epoch 21/500
193/193 [==============================] - 1s 8ms/step - loss: 20.7547 - r_squared: 0.5432 - val_loss: 21.2635 - val_r_squared: 0.5431
Epoch 22/500
193/193 [==============================] - 1s 7ms/step - loss: 20.7753 - r_squared: 0.5422 - val_loss: 21.2067 - val_r_squared: 0.5461
Epoch 23/500
193/193 [==============================] - 1s 8ms/step - loss: 20.6500 - r_squared: 0.5464 - val_loss: 21.1373 - val_r_squared: 0.5487
Epoch 24/500
193/193 [==============================] - 1s 7ms/step - loss: 20.5231 - r_squared: 0.5527 - val_loss: 21.0824 - val_r_squared: 0.5514
Epoch 25/500
193/193 [==============================] - 1s 7ms/step - loss: 20.5615 - r_squared: 0.5518 - val_loss: 21.0538 - val_r_squared: 0.5529
Epoch 26/500
193/193 [==============================] - 1s 6ms/step - loss: 20.4656 - r_squared: 0.5556 - val_loss: 20.9644 - val_r_squared: 0.5563
Epoch 27/500
193/193 [==============================] - 2s 9ms/step - loss: 20.3937 - r_squared: 0.5576 - val_loss: 20.9406 - val_r_squared: 0.5575
Epoch 28/500
193/193 [==============================] - 1s 7ms/step - loss: 20.3288 - r_squared: 0.5607 - val_loss: 20.8838 - val_r_squared: 0.5600
Epoch 29/500
193/193 [==============================] - 1s 6ms/step - loss: 20.2487 - r_squared: 0.5636 - val_loss: 20.8939 - val_r_squared: 0.5600
Epoch 30/500
193/193 [==============================] - 1s 6ms/step - loss: 20.1414 - r_squared: 0.5691 - val_loss: 20.8106 - val_r_squared: 0.5628
Epoch 31/500
193/193 [==============================] - 1s 8ms/step - loss: 20.1524 - r_squared: 0.5686 - val_loss: 20.7338 - val_r_squared: 0.5663
Epoch 32/500
193/193 [==============================] - 1s 7ms/step - loss: 20.1052 - r_squared: 0.5721 - val_loss: 20.7422 - val_r_squared: 0.5665
Epoch 33/500
193/193 [==============================] - 1s 6ms/step - loss: 20.0621 - r_squared: 0.5730 - val_loss: 20.6402 - val_r_squared: 0.5702
Epoch 34/500
193/193 [==============================] - 1s 6ms/step - loss: 19.9559 - r_squared: 0.5765 - val_loss: 20.5860 - val_r_squared: 0.5727
Epoch 35/500
193/193 [==============================] - 1s 8ms/step - loss: 19.9740 - r_squared: 0.5777 - val_loss: 20.5348 - val_r_squared: 0.5746
Epoch 36/500
193/193 [==============================] - 1s 7ms/step - loss: 19.6978 - r_squared: 0.5847 - val_loss: 20.5523 - val_r_squared: 0.5744
Epoch 37/500
193/193 [==============================] - 1s 6ms/step - loss: 19.7957 - r_squared: 0.5834 - val_loss: 20.4450 - val_r_squared: 0.5783
Epoch 38/500
193/193 [==============================] - 1s 6ms/step - loss: 19.8010 - r_squared: 0.5848 - val_loss: 20.4400 - val_r_squared: 0.5785
Epoch 39/500
193/193 [==============================] - 1s 7ms/step - loss: 19.6799 - r_squared: 0.5903 - val_loss: 20.3838 - val_r_squared: 0.5809
Epoch 40/500
193/193 [==============================] - 1s 7ms/step - loss: 19.6889 - r_squared: 0.5882 - val_loss: 20.3456 - val_r_squared: 0.5823
Epoch 41/500
193/193 [==============================] - 1s 7ms/step - loss: 19.7166 - r_squared: 0.5888 - val_loss: 20.3371 - val_r_squared: 0.5830
Epoch 42/500
193/193 [==============================] - 2s 8ms/step - loss: 19.6154 - r_squared: 0.5935 - val_loss: 20.2858 - val_r_squared: 0.5850
Epoch 43/500
193/193 [==============================] - 1s 8ms/step - loss: 19.5231 - r_squared: 0.5954 - val_loss: 20.2556 - val_r_squared: 0.5862
Epoch 44/500
193/193 [==============================] - 2s 8ms/step - loss: 19.5024 - r_squared: 0.5966 - val_loss: 20.2182 - val_r_squared: 0.5878
Epoch 45/500
193/193 [==============================] - 1s 7ms/step - loss: 19.4723 - r_squared: 0.5983 - val_loss: 20.2012 - val_r_squared: 0.5891
Epoch 46/500
193/193 [==============================] - 2s 9ms/step - loss: 19.4292 - r_squared: 0.5991 - val_loss: 20.1666 - val_r_squared: 0.5904
Epoch 47/500
193/193 [==============================] - 1s 7ms/step - loss: 19.3681 - r_squared: 0.6032 - val_loss: 20.1253 - val_r_squared: 0.5922
Epoch 48/500
193/193 [==============================] - 1s 7ms/step - loss: 19.3494 - r_squared: 0.6045 - val_loss: 20.1051 - val_r_squared: 0.5930
Epoch 49/500
193/193 [==============================] - 2s 9ms/step - loss: 19.2419 - r_squared: 0.6060 - val_loss: 20.0870 - val_r_squared: 0.5940
Epoch 50/500
193/193 [==============================] - 1s 8ms/step - loss: 19.2241 - r_squared: 0.6075 - val_loss: 20.0426 - val_r_squared: 0.5956
Epoch 51/500
150/193 [======================>.......] - ETA: 0s - loss: 19.1960 - r_squared: 0.60856075 - val_loss: 20.0835 - val_r_squared: 0.5944
Epoch 52/500
193/193 [==============================] - 1s 8ms/step - loss: 19.1283 - r_squared: 0.6132 - val_loss: 19.9330 - val_r_squared: 0.6001
Epoch 53/500
193/193 [==============================] - 1s 8ms/step - loss: 19.1283 - r_squared: 0.6132 - val_loss: 19.9330 - val_r_squared: 0.6001
Epoch 54/500
193/193 [==============================] - 1s 7ms/step - loss: 19.1242 - r_squared: 0.6133 - val_loss: 19.9018 - val_r_squared: 0.6011
Epoch 55/500
106/193 [===============>..............] - ETA: 0s - loss: 18.5480 - r_squared: 0.6185
163/193 [========================>.....] - ETA: 0s - loss: 19.1407 - r_squared: 0.61756133 - val_loss: 19.9018 - val_r_squared: 0.6011
193/193 [==============================] - 2s 9ms/step - loss: 18.9724 - r_squared: 0.6185 - val_loss: 19.8766 - val_r_squared: 0.6027
193/193 [==============================] - 2s 9ms/step - loss: 18.9724 - r_squared: 0.6185 - val_loss: 19.8766 - val_r_squared: 0.6027
Traceback (most recent call last):
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/training/portion_model.py", line 221, in <module>
    main()
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/training/portion_model.py", line 215, in main
    iteratively_train_models(data, meal_type)
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/training/portion_model.py", line 205, in iteratively_train_models
    result = train_portion_model(reduced_data, nn.model_save_path, meal_type, wb_group_name)
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/training/portion_model.py", line 159, in train_portion_model
    avg_metrics, agg_metrics, best_model = cross_validate_model(X_train, y_train, logpath, meal_type, wb_group_name)
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/training/portion_model.py", line 125, in cross_validate_model
    nn.train(X_fold_train, y_fold_train, X_fold_val, y_fold_val)
  File "/mnt/e/Personal/UC Davis/Research/Ilias/AIFS Projects/diet_recommendation/meal_recommender/src/training/portion_model.py", line 55, in train
    self.model.fit(
  File "/home/unixftwx/anaconda3/envs/drp/lib/python3.10/site-packages/keras/src/utils/traceback_utils.py", line 65, in error_handler
    return fn(*args, **kwargs)
  File "/home/unixftwx/anaconda3/envs/drp/lib/python3.10/site-packages/keras/src/engine/training.py", line 1733, in fit
    for step in data_handler.steps():
  File "/home/unixftwx/anaconda3/envs/drp/lib/python3.10/site-packages/keras/src/engine/data_adapter.py", line 1401, in steps
    original_spe = self._steps_per_execution.numpy().item()
  File "/home/unixftwx/anaconda3/envs/drp/lib/python3.10/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 688, in numpy
    return self.read_value().numpy()
  File "/home/unixftwx/anaconda3/envs/drp/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1141, in numpy
    maybe_arr = self._numpy()  # pylint: disable=protected-access
  File "/home/unixftwx/anaconda3/envs/drp/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 1107, in _numpy
    return self._numpy_internal()
KeyboardInterrupt